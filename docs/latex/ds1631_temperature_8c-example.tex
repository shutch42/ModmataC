\hypertarget{ds1631_temperature_8c-example}{}\doxysection{ds1631\+\_\+temperature.\+c}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{ModmataC_8h}{ModmataC.h}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#define THERMO\_ADDR 0X4D}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main() \{}
\DoxyCodeLine{    \textcolor{comment}{// start serial connection with arduino, given a port, baud rate, and id}}
\DoxyCodeLine{    \mbox{\hyperlink{ModmataC_8c_a1bf4e4b24163ed99bc92c833adc79dbf}{connectArduino}}(\textcolor{stringliteral}{"{}/dev/ttyACM0"{}}, 115200, 1);}
\DoxyCodeLine{    printf(\textcolor{stringliteral}{"{}Arduino connected\(\backslash\)n"{}});}
\DoxyCodeLine{    }
\DoxyCodeLine{    \mbox{\hyperlink{ModmataC_8c_ab0cd854f2fd35c0579204367c2200ef3}{wireBegin}}();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Read in initial config settings}}
\DoxyCodeLine{    uint8\_t *config = \mbox{\hyperlink{ModmataC_8c_a295a3697953e2d14dad8d7f4df89ad13}{wireRead}}(THERMO\_ADDR, 0xAC, 1);}
\DoxyCodeLine{    \textcolor{comment}{// Modify config settings}}
\DoxyCodeLine{    config[1] |= 0x0D;}
\DoxyCodeLine{    \mbox{\hyperlink{ModmataC_8c_a04194e45cf75e13189b326f2b727485f}{wireWrite}}(THERMO\_ADDR, 0xAC, 1, config);}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{keywordflow}{while}(1) \{}
\DoxyCodeLine{        \textcolor{comment}{// Start temperature conversion}}
\DoxyCodeLine{        \mbox{\hyperlink{ModmataC_8c_a04194e45cf75e13189b326f2b727485f}{wireWrite}}(THERMO\_ADDR, 0x51, 0, 0);}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{comment}{// Read in temperature bytes}}
\DoxyCodeLine{        uint8\_t *bytes = \mbox{\hyperlink{ModmataC_8c_a295a3697953e2d14dad8d7f4df89ad13}{wireRead}}(THERMO\_ADDR, 0xAA, 2);}
\DoxyCodeLine{        \textcolor{comment}{// printf("{}\%02x \%02x\(\backslash\)n"{}, bytes[0], bytes[1]);}}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{comment}{// Convert bytes to temperature number}}
\DoxyCodeLine{        \textcolor{keywordtype}{double} temperature\_c = 0;}
\DoxyCodeLine{        temperature\_c += bytes[0];}
\DoxyCodeLine{        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 4; i++) \{}
\DoxyCodeLine{            temperature\_c += ((bytes[1] >> 4+i) \& 0x01) / pow(2, i+1);}
\DoxyCodeLine{        \}}
\DoxyCodeLine{        printf(\textcolor{stringliteral}{"{}\%.04f F\(\backslash\)n"{}}, temperature\_c * 9/5.0 + 32);}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{comment}{// Wait a second until the next sample}}
\DoxyCodeLine{        free(bytes);}
\DoxyCodeLine{        \mbox{\hyperlink{ModmataC_8c_ac0fed4fb18bece58c851f7d76f8ebe38}{delay}}(1000);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \mbox{\hyperlink{ModmataC_8c_aaf912c696192e6a13eb70526891b4cd2}{closeConnection}}();}
\DoxyCodeLine{    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}

\end{DoxyCodeInclude}
 